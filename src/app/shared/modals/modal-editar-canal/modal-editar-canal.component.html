<ion-modal [isOpen]="isOpen" (didDismiss)="cerrarModal()" class="editar-canal-modal">
  <ng-template>
    <div class="modal-container">
      <div class="modal-header">
        <h2>Editar Canal</h2>
        <ion-button fill="clear" (click)="cerrarModal()">
          <ion-icon name="close-outline"></ion-icon>
        </ion-button>
      </div>

      <div class="modal-body">
        <form [formGroup]="canalForm" (ngSubmit)="actualizarCanal()" *ngIf="canal">
          <div class="form-grid">
            <div class="form-group">
              <label>Nombre Fantasía <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="nombreFantasia">
              <small class="text-danger" *ngIf="canalForm.get('nombreFantasia')?.invalid && canalForm.get('nombreFantasia')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>Razón Social <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="razonSocial">
              <small class="text-danger" *ngIf="canalForm.get('razonSocial')?.invalid && canalForm.get('razonSocial')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>Provincia <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="provincia">
              <small class="text-danger" *ngIf="canalForm.get('provincia')?.invalid && canalForm.get('provincia')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>Localidad <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="localidad">
              <small class="text-danger" *ngIf="canalForm.get('localidad')?.invalid && canalForm.get('localidad')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>CUIT <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="cuit">
              <small class="text-danger" *ngIf="canalForm.get('cuit')?.invalid && canalForm.get('cuit')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>CBU <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="cbu">
              <small class="text-danger" *ngIf="canalForm.get('cbu')?.invalid && canalForm.get('cbu')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>Alias <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="alias">
              <small class="text-danger" *ngIf="canalForm.get('alias')?.invalid && canalForm.get('alias')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>Banco <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="banco">
              <small class="text-danger" *ngIf="canalForm.get('banco')?.invalid && canalForm.get('banco')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>Número de Cuenta <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="numCuenta">
              <small class="text-danger" *ngIf="canalForm.get('numCuenta')?.invalid && canalForm.get('numCuenta')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>Tipo de Canal <span class="required">*</span></label>
              <select class="form-control" formControlName="tipoCanal">
                <option value="">Seleccione un tipo</option>
                <option *ngFor="let tipo of tiposCanal" [value]="tipo.id">
                  {{ tipo.nombre }}
                </option>
              </select>
              <small class="text-danger" *ngIf="canalForm.get('tipoCanal')?.invalid && canalForm.get('tipoCanal')?.touched">
                Campo requerido
              </small>
            </div>

            <div class="form-group">
              <label>Estado</label>
              <div class="toggle-container">
                <ion-toggle formControlName="activo"></ion-toggle>
                <span>{{ canalForm.get('activo')?.value ? 'Activo' : 'Inactivo' }}</span>
              </div>
            </div>
          </div>

          <div class="form-error" *ngIf="error">
            <div class="alert alert-danger">{{ error }}</div>
          </div>

          <div class="form-footer">
            <button type="button" class="btn btn-light" (click)="cerrarModal()">Cancelar</button>
            <button type="submit" class="btn btn-primary" [disabled]="loading || canalForm.invalid">
              <span *ngIf="!loading">Guardar Cambios</span>
              <ion-spinner *ngIf="loading" name="dots" class="spinner-sm"></ion-spinner>
            </button>
          </div>
        </form>
      </div>
    </div>
  </ng-template>
</ion-modal>
